
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Sign Up Login</title>
<link rel="stylesheet" href="./goodslist/index/css/login.css">
</head>
<body>
<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
<link rel='stylesheet prefetch' href='https://fonts.googleapis.com/icon?family=Material+Icons'>
<body>
<div class="cotn_principal">
<div class="cont_centrar">
<div class="cont_login">
<div class="cont_info_log_sign_up">
<div class="col_md_login">
<div class="cont_ba_opcitiy">
<h2>LOGIN</h2>
<p>Lorem ipsum dolor sit amet, consectetur.</p>
<button class="btn_login" onclick="cambiar_login()">登录</button>
</div>
</div>
<div class="col_md_sign_up">
<div class="cont_ba_opcitiy">
<h2>SIGN UP</h2>
<p>Lorem ipsum dolor sit amet, consectetur.</p>
<button class="btn_sign_up" onclick="cambiar_sign_up()">注册</button>
</div>
</div>
</div>
<div class="cont_back_info">
<div class="cont_img_back_grey"> <img src="po.jpg" alt="" /> </div>
</div>
<div class="cont_forms">
<div class="cont_img_back_"> <img src="po.jpg" alt="" /> </div>
<div class="cont_form_login"> <a href="#" onclick="ocultar_login_sign_up()"><i class="material-icons">&#xE5C4;</i></a>
<h2>LOGIN</h2>
<input type="text" name="uname" id="username" placeholder="请输入用户名"/>
<input  type="password" name="pwd"  id="pwd" placeholder="请输入密码"/>
<p class="look"><a class="look1" style="float: right;font-size:12px;color: rgb(133,133,133);margin-right: 20px">显示密码?</a></p>
<canvas width="100" height="40" style="border: 1px solid #ccc;margin-top: 20px;float: left;margin-left: 30px">对不起,浏览器版本过低,请升级!! </canvas>
<input type="text" placeholder="请输入验证码" class="inp">
<button class="btn_login button1">登录</button>
</div>
<div class="cont_form_sign_up"> <a href="#" onclick="ocultar_login_sign_up()"><i class="material-icons">&#xE5C4;</i></a>
<h2>SIGN UP</h2>
<input  id="loginName" type="text" placeholder="请输入用户名" />
<input  id="loginPsd" type="password" placeholder="请输入密码" />
<input  id="loginPsd2" type="password" placeholder="请再次输入密码" />
<button class="btn_sign_up button2">注册</button>
</div>
</div>
</div>
</div>
</div>
<script src="http://www.jq22.com/demo/dlzhi201701172342/js/index.js"></script>
<script src="./goodslist/index/js/demo.js"></script>
<script src="./jQuery.js"></script>
<script>

    //登录
    $(function(){
        $('.button1').click(function(){
            var username =$('#username').val()
            var pwd =$('#pwd').val()
            // console.log(username,pwd)
            $.ajax({
                type:'get',
                url:'http://127.0.0.1:3001',
                data:{username,pwd},
                dataType:'json',
                success(res){
                    if(res.meta.status==200){
                        if(confirm('登录成功')){
                            location.href='./index.html'
                        }
                            localStorage.setItem('name',username)
                            localStorage.setItem('id',res.data.id)
                    }else{
                        alert(res.meta.msg)
                    }
                },
                error(err){
                    console.log(err)
                }
            })
        })

        $('.look').on('click','.look1',function(){
                var pwdObj=document.querySelector('#pwd')
                var look1Obj=document.querySelector('.look1')
                pwdObj.setAttribute('type','text')
                look1Obj.setAttribute('class','look2')
        })
        $('.look').on('click','.look2',function(){
                var pwdObj=document.querySelector('#pwd')
                var look2Obj=document.querySelector('.look2')
                pwdObj.setAttribute('type','password')
                look2Obj.setAttribute('class','look1')
        })

    })


    //注册
    $('#loginName').on('keyup',function(){
        var num=$(this).val();
        num=num.replace(/[^0-9a-zA-Z]/g,"")
        $(this).val(num)
    })

    $(function(){
        $('#loginName').blur(function(){
            var username=$('#loginName').val()
            
            $.ajax({
                    type:'get',
                    url:'http://127.0.0.1:3312/',
                    data:{username},
                    dataType:'json',
                    success(res){
                        alert(res.data);
                        $('#loginName').val('');
                    },
                    error(err){
                        console.log(err)
                    }
            })
        })
            $('.button2').click(function(){
                var username=$('#loginName').val()
                var pwd=$('#loginPsd').val()
                var pwd1=$('#loginPsd2').val()
                // var pwd2=pwd==pwd1
                if(username ==""){
                alert('用户名不能为空')

                }else {

            
                if(pwd==""&&pwd1==""){
                    alert('请输入密码')
                }else{
                    if(pwd==pwd1){

                    $.ajax({

                        type:'get',
                        url:'http://127.0.0.1:3002/',
                        data:{username,pwd},
                        dataType:'json',
                        success(res){
                            if(res.meta.status==200){
                                if(confirm('注册成功')){
                                    location.href='./login.html'
                                }
                            }else{
                                alert(res.meta.msg)
                            }
                        },
                        error(err){
                            console.log(err)
                        }


                    })
                    }else{
                        alert('密码不正确')
                    }
                    
                }
            }
        
            })
    })
    </script>
</body>
</body>
</html>
